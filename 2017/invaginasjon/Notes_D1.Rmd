---
title: "Rotavirus"
author: "Advisory Service (RW & LV)"
date: "`r lubridate::today()`"
output:
  word_document: default
---

```{r setup, message=FALSE, warning=FALSE, include=FALSE}
RAWmisc::AllowFileManipulationFromInitialiseProject()
RAWmisc::InitialiseProject(
  HOME = getwd(),
  RAW = file.path(getwd(),"/data_raw/"),
  CLEAN = file.path(getwd(),"/data_clean/"),
  BAKED = file.path(getwd(),"/results_baked/"),
  FINAL = file.path(getwd(),"/results_final/"),
  SHARED = file.path(getwd(),"/results_shared/"))


suppressWarnings(suppressMessages(library(data.table)))
suppressWarnings(suppressMessages(library(ggplot2)))
suppressWarnings(suppressMessages(library(foreach)))
suppressWarnings(suppressMessages(library(pomp)))

estimates <- readRDS(file=file.path(RAWmisc::PROJ$BAKED,"estimatesD1.RDS"))
```

To obtain our numerators, we used data on cases < 2 years (103 weeks) old, registered between 2008 and 2013 in Norway.

To obtain our denominators (i.e. population), we took the yearly estimated population for each year from 2006-2013 from SSB, and then assumed a constant birthrate throughout the year.

We then fit a Poisson regression to our weekly data, using a restricted cubic spline with 6 degrees of freedom to model the non-linear age association.

We then predicted the number of IS cases for a 1-year birth cohort of children aged 0-51 weeks old, born in 2016. We then applied the following relative risks:

(First vaccination round)
RR1_1_1 <- 6.03
RR1_2_3 <- 1.13


With vaccination occurring at 6-16 weeks (inclusive) and considering the real distribution of age at vaccination for dose 1 in 2016.

```{r echo=FALSE, results='asis'}
rv <- data.table::data.table(Weeks = c(6:16, "Total: 11"), Perc.vacc = c(38.91,41.12,12.03,3.45,1.06,.49,.32,.84,.50,.18,.08, 
                                                                   sum(c(38.91,41.12,12.03,3.45,1.06,.49,.32,.84,.50,.18,.08)))  )

pander::pandoc.table((rv))
```




Our estimates below are for the estimated IS cases for a 1-year birth cohort of children aged 0-51 weeks old. The confidence intervals were generated by simulating 1000 datasets from the estimated error associated with our regression models and risk ratios, making IS estimates for each of the 1000 datasets, and then taking the 2.5th, 50th, and 97.5th percentiles.

numBaselinePredIS = NUMBER OF BASELINE CASES WITHOUT ANY VACCINATIONS
ISvaccine1 = NUMBER OF EXCESS CASES ATTRIBUTABLE TO FIRST VACCINATION ROUND


NOTE: These are estimates made about the mean number of cases of IS that we will expect from the birth cohort born in 2016. The confidence intervals represent how much certainty we have about the mean number of cases.

```{r, echo=FALSE, results='asis'}
pander::pandoc.table(estimates)
```